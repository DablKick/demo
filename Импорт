
&НаСервере
Процедура ЗагрузитьДанныеНаСервере(Результат, ДопПараметр) Экспорт
	Если Не (Результат=Неопределено) Тогда
	   СсылкаНаФайл=Результат[0];
	Иначе
	   Сообщить("Файл не выбран");
	   Возврат;
   КонецЕсли;  
   ТабДок=Новый ТабличныйДокумент;
   ТабДок.Прочитать(СсылкаНаФайл);
   Для Строка=2 По ТабДок.ВысотаТаблицы  Цикл
      ДанныеНомера=ТабДок.Область(Строка,2).Текст;
   	  Если Справочники.НомернойФонд.НайтиПоКоду(ДанныеНомера,Истина)=Справочники.НомернойФонд.ПустаяСсылка() Тогда
	      ЭлементНомерногоФонда=Справочники.НомернойФонд.СоздатьЭлемент();
	  	  ЭлементНомерногоФонда.Код=ДанныеНомера;
		  НомерЭтажа=ТабДок.Область(Строка,1).Текст;
		  Если Справочники.Этажи.НайтиПоНаименованию(НомерЭтажа,Истина)=Справочники.Этажи.ПустаяСсылка() Тогда
		       ЭлементЭтажи=Справочники.Этажи.СоздатьЭлемент();
			   ЭлементЭтажи.Наименование=НомерЭтажа;
			   ЭлементЭтажи.Записать();
		  	   Сообщить("Добавлен новый этаж "+ЭлементЭтажи.Наименование)
		  КонецЕсли;
	      ЭлементНомерногоФонда.Этаж=Справочники.Этажи.НайтиПоНаименованию(НомерЭтажа,Истина);
		  ДанныеКатегории=ТабДок.Область(Строка,3).Текст;
		  Если Справочники.Категории.НайтиПоНаименованию(ДанныеКатегории,Истина)=Справочники.Категории.ПустаяСсылка() Тогда
		       ЭлементКатегория=Справочники.Категории.СоздатьЭлемент();
			   ЭлементКатегория.Наименование=ДанныеКатегории;
			   ЭлементКатегория.Записать();
		  	   Сообщить("Добавлен новая категория "+ЭлементКатегория.Наименование);
		  КонецЕсли;
	      ЭлементНомерногоФонда.Категория=Справочники.Категории.НайтиПоНаименованию(ДанныеКатегории,Истина);
          ЭлементНомерногоФонда.Записать();
		  Сообщить("Добавлен номер "+ЭлементНомерногоФонда.Код);
	  Иначе
	      Сообщить("Номер "+ДанныеНомера+" уже существует");
	  КонецЕсли;
   КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузитьДанные(Команда)
	ВыборФайла=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ВыборФайла.МножественныйВыбор=Ложь;
	ВыборФайла.Фильтр="Табличные документы *.xlsx | *.xlsx";
	ВыборФайла.Показать(Новый ОписаниеОповещения("ЗагрузитьДанныеНаСервере", ЭтотОбъект, Новый Структура));
КонецПроцедуры
