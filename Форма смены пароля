
&НаСервере
Процедура ИзменитьПарольНаСервере()
	// Вставить содержимое обработчика.
	Если ТекущийПароль=Параметры.ПараметрПользователь.Пароль И НовыйПароль=ПодтверждениеНовогоПароля Тогда
	ДоступКОткрытию=Истина;	
	ПользовательОбъект=Параметры.ПараметрПользователь.ПолучитьОбъект();
	ПользовательОбъект.Пароль=НовыйПароль;
	ПользовательОбъект.ДатаВхода=ТекущаяДата();
	ПользовательОбъект.Записать();
	Иначе
	Сообщить("Пароли не совпадают"); 
	ДоступКОткрытию=Ложь;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ИзменитьПароль(Команда)
	ИзменитьПарольНаСервере();
	Если ДоступКОткрытию=Истина Тогда
	Если Роль=ПредопределенноеЗначение("Перечисление.Роли.Пользователь") Тогда
	ОткрытьФорму("ОбщаяФорма.ФормаПользователя");
	Сообщить("Вы успешно авторизовались и сменили пароль");
	КонецЕсли;      
	Если Роль=ПредопределенноеЗначение("Перечисление.Роли.Администратор") Тогда
	ОткрытьФорму("Справочник.Пользователи.ФормаСписка");
	Сообщить("Вы успешно авторизовались и сменили пароль");
	КонецЕсли;
    ЭтаФорма.Закрыть();
	КонецЕсли;
КонецПроцедуры


&НаСервере
Процедура ПриОткрытииНаСервере()
	//Вставить содержимое обработчика  
	Роль=Параметры.ПараметрПользователь.Роль;
КонецПроцедуры


&НаКлиенте
Процедура ПриОткрытии(Отказ)
	ПриОткрытииНаСервере();
КонецПроцедуры

